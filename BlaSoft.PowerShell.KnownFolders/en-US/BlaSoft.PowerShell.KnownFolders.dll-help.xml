<?xml version="1.0" encoding="utf-8" ?>
<helpItems schema="maml">
  <command:command xmlns:maml="http://schemas.microsoft.com/maml/2004/10" xmlns:command="http://schemas.microsoft.com/maml/dev/command/2004/10" xmlns:dev="http://schemas.microsoft.com/maml/dev/2004/10" xmlns:MSHelp="http://msdn.microsoft.com/mshelp">
    <command:details>
      <command:name>Get-KnownFolder</command:name>
      <maml:description>
        <maml:para>Gets the file information necessary to create AppLocker rules from a list of files or an event log.</maml:para>
      </maml:description>
      <maml:copyright>
        <maml:para />
      </maml:copyright>
      <command:verb>Get</command:verb>
      <command:noun>KnownFolder</command:noun>
      <dev:version />
    </command:details>
    <maml:description>
      <maml:para>The Get-KnownFolder cmdlet gets the AppLocker file information from a list of files or an event log. File information includes the publisher information, file hash, and file path.</maml:para>
      <maml:para>The file information from an event log may not contain all of the publisher information, file hash, and file path fields. Files that are not signed will not have any publisher information.</maml:para>
    </maml:description>
    <command:syntax>
      <command:syntaxItem>
        <maml:name>Get-KnownFolder</maml:name>
        <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="true (ByValue, ByPropertyName)" position="1" aliases="">
          <maml:name>Path</maml:name>
          <maml:description>
            <maml:para>Specifies a list of paths to the files from which the file information is retrieved. Supports regular expressions.</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="false">List&lt;String&gt;</command:parameterValue>
        </command:parameter>
      </command:syntaxItem>
      <command:syntaxItem>
        <maml:name>Get-KnownFolder</maml:name>
        <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
          <maml:name>FileType</maml:name>
          <maml:description>
            <maml:para>
              Specifies the generic file type for which to search. All files having the appropriate file name extension will be included.
              The acceptable values for this parameter are:  EXE, Script, MSI, and DLL.
            </maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="false">List&lt;AppLockerFileType&gt;</command:parameterValue>
        </command:parameter>
        <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
          <maml:name>Recurse</maml:name>
          <maml:description>
            <maml:para>Specifies that all files and folders within the specified directory will be searched.</maml:para>
          </maml:description>
        </command:parameter>
        <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
          <maml:name>Directory</maml:name>
          <maml:description>
            <maml:para>Specifies the directory containing the files for which to get the file information. If all subfolders and files in the specified directory are to be searched, then include the Recurse parameter</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="false">String</command:parameterValue>
        </command:parameter>
      </command:syntaxItem>
      <command:syntaxItem>
        <maml:name>Get-KnownFolder</maml:name>
        <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
          <maml:name>EventType</maml:name>
          <maml:description>
            <maml:para>Specifies the event type by which to filter the events. The acceptable values for this parameter are:  Allowed, Denied, or Audited. The event types correspond to the Informational, Error, and Warning level events in the AppLocker event logs.</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="false">List&lt;AppLockerEventType&gt;</command:parameterValue>
        </command:parameter>
        <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
          <maml:name>LogPath</maml:name>
          <maml:description>
            <maml:para>Specifies the log name or file path of the event log where the AppLocker events are located. If this parameter is not specified, the local Microsoft-Windows-AppLocker/EXE and DLL channel is used by default.</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="false">String</command:parameterValue>
        </command:parameter>
        <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
          <maml:name>Statistics</maml:name>
          <maml:description>
            <maml:para>Specifies the statistics to retrieve on the files included in the event log. Calculates a simple sum of the number of times a file is included in the event log based upon specified parameters.</maml:para>
          </maml:description>
        </command:parameter>
        <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
          <maml:name>EventLog</maml:name>
          <maml:description>
            <maml:para>Specifies that the file information is retrieved from the event log.</maml:para>
          </maml:description>
        </command:parameter>
      </command:syntaxItem>
      <command:syntaxItem>
        <maml:name>Get-KnownFolder</maml:name>
        <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="true (ByValue, ByPropertyName)" position="1" aliases="">
          <maml:name>Packages</maml:name>
          <maml:description>
            <maml:para>Specifies a list of installed packaged applications, from which the file information is retrieved.</maml:para>
          </maml:description>
          <command:parameterValue required="true" variableLength="false">List&lt;AppxPackage&gt;</command:parameterValue>
        </command:parameter>
      </command:syntaxItem>
    </command:syntax>
    <command:parameters>
      <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
        <maml:name>Directory</maml:name>
        <maml:description>
          <maml:para>Specifies the directory containing the files for which to get the file information. If all subfolders and files in the specified directory are to be searched, then include the Recurse parameter</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="false">String</command:parameterValue>
        <dev:type>
          <maml:name>String</maml:name>
          <maml:uri />
        </dev:type>
        <dev:defaultValue></dev:defaultValue>
      </command:parameter>
      <command:parameter required="true" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
        <maml:name>EventLog</maml:name>
        <maml:description>
          <maml:para>Specifies that the file information is retrieved from the event log.</maml:para>
        </maml:description>
        <command:parameterValue required="false" variableLength="false">SwitchParameter</command:parameterValue>
        <dev:type>
          <maml:name>SwitchParameter</maml:name>
          <maml:uri />
        </dev:type>
        <dev:defaultValue></dev:defaultValue>
      </command:parameter>
      <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
        <maml:name>EventType</maml:name>
        <maml:description>
          <maml:para>Specifies the event type by which to filter the events. The acceptable values for this parameter are:  Allowed, Denied, or Audited. The event types correspond to the Informational, Error, and Warning level events in the AppLocker event logs.</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="false">List&lt;AppLockerEventType&gt;</command:parameterValue>
        <dev:type>
          <maml:name>List&lt;AppLockerEventType&gt;</maml:name>
          <maml:uri />
        </dev:type>
        <dev:defaultValue>Allowed, Denied, Audited</dev:defaultValue>
      </command:parameter>
      <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
        <maml:name>FileType</maml:name>
        <maml:description>
          <maml:para>
            Specifies the generic file type for which to search. All files having the appropriate file name extension will be included.
            The acceptable values for this parameter are:  EXE, Script, MSI, and DLL.
          </maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="false">List&lt;AppLockerFileType&gt;</command:parameterValue>
        <dev:type>
          <maml:name>List&lt;AppLockerFileType&gt;</maml:name>
          <maml:uri />
        </dev:type>
        <dev:defaultValue>Exe, Script, MSI, Dll</dev:defaultValue>
      </command:parameter>
      <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
        <maml:name>LogPath</maml:name>
        <maml:description>
          <maml:para>Specifies the log name or file path of the event log where the AppLocker events are located. If this parameter is not specified, the local Microsoft-Windows-AppLocker/EXE and DLL channel is used by default.</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="false">String</command:parameterValue>
        <dev:type>
          <maml:name>String</maml:name>
          <maml:uri />
        </dev:type>
        <dev:defaultValue></dev:defaultValue>
      </command:parameter>
      <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="true (ByValue, ByPropertyName)" position="1" aliases="">
        <maml:name>Packages</maml:name>
        <maml:description>
          <maml:para>Specifies a list of installed packaged applications, from which the file information is retrieved.</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="false">List&lt;AppxPackage&gt;</command:parameterValue>
        <dev:type>
          <maml:name>List&lt;AppxPackage&gt;</maml:name>
          <maml:uri />
        </dev:type>
        <dev:defaultValue></dev:defaultValue>
      </command:parameter>
      <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="true (ByValue, ByPropertyName)" position="1" aliases="">
        <maml:name>Path</maml:name>
        <maml:description>
          <maml:para>Specifies a list of paths to the files from which the file information is retrieved. Supports regular expressions.</maml:para>
        </maml:description>
        <command:parameterValue required="true" variableLength="false">List&lt;String&gt;</command:parameterValue>
        <dev:type>
          <maml:name>List&lt;String&gt;</maml:name>
          <maml:uri />
        </dev:type>
        <dev:defaultValue></dev:defaultValue>
      </command:parameter>
      <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
        <maml:name>Recurse</maml:name>
        <maml:description>
          <maml:para>Specifies that all files and folders within the specified directory will be searched.</maml:para>
        </maml:description>
        <command:parameterValue required="false" variableLength="false">SwitchParameter</command:parameterValue>
        <dev:type>
          <maml:name>SwitchParameter</maml:name>
          <maml:uri />
        </dev:type>
        <dev:defaultValue></dev:defaultValue>
      </command:parameter>
      <command:parameter required="false" variableLength="false" globbing="false" pipelineInput="false" position="named" aliases="">
        <maml:name>Statistics</maml:name>
        <maml:description>
          <maml:para>Specifies the statistics to retrieve on the files included in the event log. Calculates a simple sum of the number of times a file is included in the event log based upon specified parameters.</maml:para>
        </maml:description>
        <command:parameterValue required="false" variableLength="false">SwitchParameter</command:parameterValue>
        <dev:type>
          <maml:name>SwitchParameter</maml:name>
          <maml:uri />
        </dev:type>
        <dev:defaultValue></dev:defaultValue>
      </command:parameter>
    </command:parameters>
    <command:inputTypes>
      <command:inputType>
        <dev:type>
          <maml:name>None</maml:name>
          <maml:uri></maml:uri>
          <maml:description>
            <maml:para />
          </maml:description>
        </dev:type>
        <maml:description></maml:description>
      </command:inputType>
    </command:inputTypes>
    <command:returnValues>
      <command:returnValue>
        <dev:type>
          <maml:name>BlaSoft.PowerShell.KnownFolders.KnownFolder</maml:name>
          <maml:uri></maml:uri>
          <maml:description>
            <maml:para />
          </maml:description>
        </dev:type>
        <maml:description></maml:description>
      </command:returnValue>
    </command:returnValues>
    <command:terminatingErrors />
    <command:nonTerminatingErrors />
    <command:examples>
      <command:example>
        <maml:title>EXAMPLE 1</maml:title>
        <maml:introduction>
          <maml:para></maml:para>
        </maml:introduction>
        <dev:code>
          PS C:\&gt;Get-AppLockerFileInformation -Directory C:\Windows\system32\ -Recurse -FileType exe, script
        </dev:code>
        <dev:remarks>
          <maml:para>This example gets the file information for all the .exe files and scripts under %windir%\system32.</maml:para>
        </dev:remarks>
        <command:commandLines>
          <command:commandLine>
            <command:commandText />
          </command:commandLine>
        </command:commandLines>
      </command:example>
      <command:example>
        <maml:title>EXAMPLE 2</maml:title>
        <maml:introduction>
          <maml:para></maml:para>
        </maml:introduction>
        <dev:code>
          PS C:\&gt;Get-AppLockerFileInformation -Path "C:\Program Files (x86)\Internet Explorer\iexplore.exe" | Format-List
          Path      : %PROGRAMFILES%\INTERNET EXPLORER\IEXPLORE.EXE
          Publisher : CN=WINDOWS MAIN BUILD LAB ACCOUNT\WINDOWS® INTERNET EXPLORER\IEXPLORE.EXE,10.0.8421.0
          Hash      : SHA256 0x5F374C2DD91A6F9E9E96F149EE221EC0454649F50E1AF6D3DAEFB849FB7C551C
          AppX      : False


          PS C:\&gt;Get-AppLockerFileInformation -Path "C:\Program Files\Internet Explorer\iexplore.exe" | Format-List
          Path      : %PROGRAMFILES%\INTERNET EXPLORER\IEXPLORE.EXE
          Publisher : CN=WINDOWS MAIN BUILD LAB ACCOUNT\WINDOWS® INTERNET EXPLORER\IEXPLORE.EXE,10.0.8421.0
          Hash      : SHA256 0x5F374C2DD91A6F9E9E96F149EE221EC0454649F50E1AF6D3DAEFB849FB7C551C
          AppX      : False
        </dev:code>
        <dev:remarks>
          <maml:para>This example gets the file information for the file specified by the path.</maml:para>
        </dev:remarks>
        <command:commandLines>
          <command:commandLine>
            <command:commandText />
          </command:commandLine>
        </command:commandLines>
      </command:example>
      <command:example>
        <maml:title>EXAMPLE 3</maml:title>
        <maml:introduction>
          <maml:para></maml:para>
        </maml:introduction>
        <dev:code>
          PS C:\&gt;Get-AppXPackage –AllUsers | Get-AppLockerFileInformation
          Path      : windows.immersivecontrolpanel_6.2.0.0_neutral_neutral_cw5n1h2txyewy.appx
          Publisher : CN=Microsoft Windows, O=Microsoft Corporation, L=Redmond, S=Washington,
          C=US\windows.immersivecontrolpanel\APPX,6.2.0.0
          Hash      :
          AppX      : True

          Path      : windows.RemoteDesktop_1.0.0.0_neutral_neutral_cw5n1h2txyewy.appx
          Publisher : CN=Microsoft Windows, O=Microsoft Corporation, L=Redmond, S=Washington,
          C=US\windows.RemoteDesktop\APPX,1.0.0.0
          Hash      :
          AppX      : True

          Path      : WinStore_1.0.0.0_neutral_neutral_cw5n1h2txyewy.appx
          Publisher : CN=Microsoft Windows, O=Microsoft Corporation, L=Redmond, S=Washington, C=US\WinStore\APPX,1.0.0.0
          Hash      :
          AppX      : True
        </dev:code>
        <dev:remarks>
          <maml:para>This example outputs the file information for all the packaged applications installed on this machine for all users.</maml:para>
        </dev:remarks>
        <command:commandLines>
          <command:commandLine>
            <command:commandText />
          </command:commandLine>
        </command:commandLines>
      </command:example>
      <command:example>
        <maml:title>EXAMPLE 4</maml:title>
        <maml:introduction>
          <maml:para></maml:para>
        </maml:introduction>
        <dev:code>
          PS C:\&gt;Get-AppLockerFileInformation -EventLog -EventType Audited

        </dev:code>
        <dev:remarks>
          <maml:para>This example outputs the file information for all the Audited events in the local event log. Audited events correspond to the Warning event in the AppLocker audit log.</maml:para>
        </dev:remarks>
        <command:commandLines>
          <command:commandLine>
            <command:commandText />
          </command:commandLine>
        </command:commandLines>
      </command:example>
      <command:example>
        <maml:title>EXAMPLE 5</maml:title>
        <maml:introduction>
          <maml:para></maml:para>
        </maml:introduction>
        <dev:code>
          PS C:\&gt;Get-AppLockerFileInformation -EventLog -EventType Allow -Statistics
        </dev:code>
        <dev:remarks>
          <maml:para>This example displays statistics for all the Allowed events in the local event log. For each file in the event log, the cmdlet will sum the number of times the event type occurred.</maml:para>
        </dev:remarks>
        <command:commandLines>
          <command:commandLine>
            <command:commandText />
          </command:commandLine>
        </command:commandLines>
      </command:example>
      <command:example>
        <maml:title>EXAMPLE 6</maml:title>
        <maml:introduction>
          <maml:para></maml:para>
        </maml:introduction>
        <dev:code>
          PS C:\&gt;Get-AppLockerFileInformation -EventLog -EventType Audited | New-AppLockerPolicy -RuleType Publisher, Hash, Path -User Everyone -Optimize | Set-AppLockerPolicy -LDAP LDAP://TestGPO
        </dev:code>
        <dev:remarks>
          <maml:para>This example creates a new AppLocker policy from the warning events in the local event log and sets the policy of a test Group Policy Object (GPO).</maml:para>
        </dev:remarks>
        <command:commandLines>
          <command:commandLine>
            <command:commandText />
          </command:commandLine>
        </command:commandLines>
      </command:example>
    </command:examples>
    <maml:relatedLinks>
      <maml:navigationLink>
        <maml:linkText>IKnownFolder interface on MSDN:</maml:linkText>
        <maml:uri>http://msdn.microsoft.com/en-us/library/windows/desktop/bb761768.aspx</maml:uri>
      </maml:navigationLink>
      <maml:navigationLink>
        <maml:linkText>Move-KnownFolder</maml:linkText>
        <maml:uri />
      </maml:navigationLink>
    </maml:relatedLinks>
  </command:command>

</helpItems>